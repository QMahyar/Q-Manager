import{j as e,r as d}from"./vendor-react-gZ_13g0c.js";import{D as R,f as F,a as S,b as L,c as M,d as B,L as m,I as P,B as f}from"./label-KQfz7kZ3.js";import{c as z,B as p}from"./index-CIGRwQmS.js";import{S as $}from"./switch-Cwk0l8Yd.js";import{I as A,r as b,N as y,J as O}from"./vendor-icons-DG3TFKsj.js";function V({className:i,...c}){return e.jsx("textarea",{"data-slot":"textarea",className:z("border-input dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 rounded-md border bg-transparent px-2.5 py-2 text-base shadow-xs transition-[color,box-shadow] focus-visible:ring-[3px] aria-invalid:ring-[3px] md:text-sm placeholder:text-muted-foreground flex field-sizing-content min-h-16 w-full outline-none disabled:cursor-not-allowed disabled:opacity-50",i),...c})}function K({pattern:i,isRegex:c,onPatternChange:x,onIsRegexChange:j,trigger:v}){const[T,g]=d.useState(!1),[a,k]=d.useState(""),[o,N]=d.useState(i),[h,w]=d.useState(c),C=s=>{s&&(N(i),w(c)),g(s)},r=d.useMemo(()=>{if(!o||!a)return{valid:!0,matches:[],error:null};try{if(h){const s=new RegExp(o,"gi"),t=[];let l;for(;(l=s.exec(a))!==null;)t.push({match:l[0],index:l.index,groups:l.slice(1).length>0?l.slice(1):void 0}),l[0].length===0&&s.lastIndex++;return{valid:!0,matches:t,error:null}}else{const s=[];let t=0;const l=a.toLowerCase(),n=o.toLowerCase();for(;(t=l.indexOf(n,t))!==-1;)s.push({match:a.slice(t,t+o.length),index:t}),t+=o.length;return{valid:!0,matches:s,error:null}}}catch(s){return{valid:!1,matches:[],error:s instanceof Error?s.message:"Invalid pattern"}}},[o,h,a]),I=d.useMemo(()=>{if(!a||r.matches.length===0)return a;const s=[];let t=0;return[...r.matches].sort((n,u)=>n.index-u.index).forEach((n,u)=>{n.index>t&&s.push(e.jsx("span",{children:a.slice(t,n.index)},`text-${u}`)),s.push(e.jsx("mark",{className:"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded",children:n.match},`match-${u}`)),t=n.index+n.match.length}),t<a.length&&s.push(e.jsx("span",{children:a.slice(t)},"text-end")),s},[a,r.matches]),D=()=>{x?.(o),j?.(h),g(!1)},E=v||e.jsx(p,{variant:"outline",size:"icon-sm",title:"Test pattern",children:e.jsx(O,{className:"size-4"})});return e.jsxs(R,{open:T,onOpenChange:C,children:[e.jsx(F,{children:E}),e.jsxs(S,{className:"max-w-2xl",children:[e.jsxs(L,{children:[e.jsx(M,{children:"Test Pattern"}),e.jsx(B,{children:"Test your pattern against sample text to see if it matches correctly."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"pattern",children:"Pattern"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{htmlFor:"isRegex",className:"text-sm text-muted-foreground",children:"Regex"}),e.jsx($,{id:"isRegex",checked:h,onCheckedChange:w})]})]}),e.jsx(P,{id:"pattern",value:o,onChange:s=>N(s.target.value),placeholder:h?"Enter regex pattern...":"Enter substring...",className:`font-mono ${r.valid?"":"border-destructive"}`}),!r.valid&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(A,{className:"size-4"}),r.error]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"testText",children:"Sample Text"}),e.jsx(V,{id:"testText",value:a,onChange:s=>k(s.target.value),placeholder:"Paste or type sample text to test against...",rows:4})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{children:"Result"}),a&&e.jsx(f,{variant:r.matches.length>0?"default":"secondary",className:"gap-1",children:r.matches.length>0?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-3 w-3"}),r.matches.length," match",r.matches.length!==1?"es":""]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-3 w-3"}),"No matches"]})})]}),a&&e.jsx("div",{className:"p-3 bg-muted rounded-md font-mono text-sm whitespace-pre-wrap break-all max-h-40 overflow-auto",children:I}),r.matches.some(s=>s.groups&&s.groups.length>0)&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{className:"text-xs text-muted-foreground",children:"Capture Groups"}),r.matches.map((s,t)=>s.groups?e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Match ",t+1,":"]}),s.groups.map((l,n)=>e.jsxs(f,{variant:"outline",className:"font-mono",children:["$",n+1,": ",l]},n))]},t):null)]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(p,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(x||j)&&e.jsx(p,{onClick:D,disabled:!r.valid,children:"Apply Changes"})]})]})]})}function Q({pattern:i,isRegex:c}){const x=d.useMemo(()=>{if(!i||!c)return!0;try{return new RegExp(i),!0}catch{return!1}},[i,c]);return!i||!c?null:e.jsx(f,{variant:x?"outline":"destructive",className:"gap-1 text-xs",children:x?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-3 w-3"}),"Valid"]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-3 w-3"}),"Invalid"]})})}export{K as R,Q as a};
